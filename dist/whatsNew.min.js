/**
 *  WhatsNew.js
 *
 *  WhatsNew.js is a plugin that helps you create modal with steps to your website
 *
 *  Version: 0.9.0
 *
 *  Author: Benny Luk <bennyluk.dev@gmail.com>
 *  Website: https://bennyluk.github.io
 *
 */

!function(e){"use strict";function t(e,t,s){"function"==typeof t.options[e]&&t.options[e].call(t,n({event:e,whatsNew:t,slides:t.slides,currentIndex:t.currentIndex,el:t.el,overlay:t.overlay},s))}function n(e,t){var n;for(n in t)t.hasOwnProperty(n)&&(e[n]=t[n]);return e}function s(e){for(var n="",s=0;s<e.slides.length;s++){var i=e.slides[s],o=e.options.showHeader&&i.title?"<div class='whatsnew-slide-title'>"+i.title+"</div>":"",a="";i.custom?a=i.custom:(i.img&&(a+="<img class='whatsnew-img' src='"+i.img+"'>"),i.content&&(a+="<div class='whatsnew-content'>"+i.content+"</div>")),n=n.concat("<div class='whatsnew-slide' style='width: "+e.options.width+"px'>"+o+"<div class='whatsnew-slide-content'>"+a+"</div></div>")}var l=e.options.showClose?"<a href='#' class='whatsnew-close'>x</a>":"",r="";if(e.options.navBullet){r="<ul class='whatsnew-nav'>";for(var h=0;s<e.slides.length;h++)r+="<li class='whatsnew-nav-item'></li>";r+="</ul>"}var w="";e.options.navBtn&&(w="<div class='whatsnew-btns'></div>");var c="";e.options.navArrow&&(c="<div class='whatsnew-nav-arrows'><div class='whatsnew-nav-arrow whatsnew-nav-arrow-prev'>a</div><div class='whatsnew-nav-arrow whatsnew-nav-arrow-next'>a</div></div>"),e.el=document.createElement("div"),e.el.className="whatsnew "+e.options.class,e.el.innerHTML=l+"<div class='whatsnew-slides-container' style='width: "+e.options.width*e.slides.length+"px'>"+n+"</div>"+c+"<div class='whatsnew-footer'>"+w+r+"</div>",e.el.style.width=e.options.width+"px",e.el.style.height=e.options.height+"px",e.options.container.appendChild(e.el),e.options.overlay&&(e.overlay=document.createElement("div"),e.overlay.className="whatsnew-overlay",e.options.container.appendChild(e.overlay)),t("onRender",e)}function i(e){if(e.options.navBullet)for(var t=e.el.getElementsByClassName("whatsnew-nav-item"),n=0;n<t.length;n++)n===e.currentIndex?c(t[n],"whatsnew-nav-item-active"):d(t[n],"whatsnew-nav-item-active");o(e)}function o(e){if(e.options.navBtn){var t="";t=0===e.currentIndex?"<a href='#' class='whatsnew-btn whatsnew-next whatsnew-full-width-btn'>"+e.options.nextLabel+"</a>":e.currentIndex===e.slides.length-1?"<a href='#' class='whatsnew-btn whatsnew-prev'>"+e.options.prevLabel+"</a><a href='#' class='whatsnew-btn whatsnew-next'>"+e.options.finishLabel+"</a>":"<a href='#' class='whatsnew-btn whatsnew-prev'>"+e.options.prevLabel+"</a><a href='#' class='whatsnew-btn whatsnew-next'>"+e.options.nextLabel+"</a>",e.el.getElementsByClassName("whatsnew-btns")[0].innerHTML=t}}function a(t){if(t.options.navBullet)for(var n=t.el.getElementsByClassName("whatsnew-nav-item"),s=0;s<n.length;s++)n[s].addEventListener("click",function(){for(var e=this.parentNode.childNodes,n=0;n<e.length;n++)e[n]===this&&t.goTo(n)});t.options.showClose&&t.el.getElementsByClassName("whatsnew-close")[0].addEventListener("click",function(){t.close()}),t.options.nextOnClick&&t.el.getElementsByClassName("whatsnew-slides-container")[0].addEventListener("click",function(){t.next()}),t.options.navBtn&&t.el.getElementsByClassName("whatsnew-btns")[0].addEventListener("click",function(e){w(e.target,"whatsnew-next")?t.next():w(e.target,"whatsnew-prev")&&t.prev()}),t.options.enableKeyBinding&&(t._keydown=function(e){var n=e.keyCode;n&&(37===n?t.prev():39===n?t.next():27===n&&t.close())},document.addEventListener("keydown",t._keydown)),e.addEventListener("resize",t.adjustPosition)}function l(t){t.options.enableKeyBinding&&document.removeEventListener("keydown",t._keydown),e.removeEventListener("resize",t.adjustPosition)}function r(e){return new RegExp("(^|\\s+)"+e+"(\\s+|$)")}var h={onInit:null,onRender:null,onStart:null,onEnd:null,onNext:null,onPrevious:null,onSlideChange:null,showHeader:!0,showClose:!0,class:"",container:document.body,navBullet:!0,startIndex:0,width:350,height:500,overlay:!0,navBtn:!0,navArrow:!1,nextOnClick:!1,nextLabel:"Next",prevLabel:"Back",finishLabel:"Close",enableKeyBinding:!0,canGoPrev:null,canGoNext:null};e.WhatsNew=function(){if(this.slides=[],this.currentIndex=0,this.el=null,this.overlay=null,this.options=h,!arguments[0]||"object"!=typeof arguments[0])throw"Slides Not Found";this.slides=arguments[0],arguments[1]&&"object"==typeof arguments[1]&&(this.options=n(h,arguments[1])),t("onInit",this)},WhatsNew.prototype.start=function(){return s(this),a(this),this.goTo(this.options.startIndex),c(this.el,"show"),this.adjustPosition(),t("onStart",this),this},WhatsNew.prototype.adjustPosition=function(){var e=this.options.container.getBoundingClientRect(),t=e.width/2-this.options.width/2,n=e.height/2-this.options.height/2;return this.el.style.left=t+"px",this.el.style.top=n+"px",this},WhatsNew.prototype.goTo=function(e){var n=this.el.getElementsByClassName("whatsnew-slide");if(n[e]){this.currentIndex=e,n=n[e];for(var s=this.el.getElementsByClassName("whatsnew-slide"),o=0;o<s.length;o++)o===this.currentIndex?c(s[o],"whatsnew-slide-active"):d(s[o],"whatsnew-slide-active");i(this),this.el.getElementsByClassName("whatsnew-slides-container")[0].style.transform="translate3d(-"+this.options.width*e+"px, 0, 0)",t("onSlideChange",this)}},WhatsNew.prototype.next=function(){this.currentIndex+1>=this.slides.length?this.close():(this.goTo(this.currentIndex+1),t("onNext",this))},WhatsNew.prototype.prev=function(){this.goTo(this.currentIndex-1),t("onPrevious",this)},WhatsNew.prototype.close=function(){l(this),this.options.container.removeChild(this.el),this.options.container.removeChild(this.overlay),t("onEnd",this)};var w,c,d;"classList"in document.documentElement?(w=function(e,t){return e.classList.contains(t)},c=function(e,t){e.classList.add(t)},d=function(e,t){e.classList.remove(t)}):(w=function(e,t){return r(t).test(e.className)},c=function(e,t){w(e,t)||(e.className=e.className+" "+t)},d=function(e,t){e.className=e.className.replace(r(t)," ")})}(window);